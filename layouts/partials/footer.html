<footer class="bg-tomato">
    <div class="container py-16">
        <div class="flex flex-col gap-12 md:flex-row md:gap-24">
            <div class="flex flex-shrink-0 gap-8">
                <img src="/img/logo.svg" class="h-32" />
                <div>
                    <p class="text-sm font-medium text-white">
                        Skátafélagið Skjöldungar
                    </p>
                    <p class="mt-2 text-sm font-medium text-gray-100">
                        Sólheimum 21a
                    </p>
                    <p class="text-sm font-medium text-gray-100">
                        104 Reykjavík
                    </p>
                    <a
                        href="mailto:skjoldungar@skatar.is"
                        class="mt-3 flex items-center gap-1 text-sm text-gray-100 hover:opacity-80"
                    >
                        <svg
                            class="h-3.5 w-3.5"
                            data-slot="icon"
                            fill="currentColor"
                            viewBox="0 0 24 24"
                            xmlns="http://www.w3.org/2000/svg"
                            aria-hidden="true"
                        >
                            <path
                                clip-rule="evenodd"
                                fill-rule="evenodd"
                                d="M1.5 4.5a3 3 0 0 1 3-3h1.372c.86 0 1.61.586 1.819 1.42l1.105 4.423a1.875 1.875 0 0 1-.694 1.955l-1.293.97c-.135.101-.164.249-.126.352a11.285 11.285 0 0 0 6.697 6.697c.103.038.25.009.352-.126l.97-1.293a1.875 1.875 0 0 1 1.955-.694l4.423 1.105c.834.209 1.42.959 1.42 1.82V19.5a3 3 0 0 1-3 3h-2.25C8.552 22.5 1.5 15.448 1.5 6.75V4.5Z"
                            ></path>
                        </svg>
                        <span>+354 568 6802</span>
                    </a>
                    <a
                        href="mailto:skjoldungar@skatar.is"
                        class="mt-2 flex items-center gap-1 text-sm text-gray-100 hover:opacity-80"
                    >
                        <svg
                            class="h-3.5 w-3.5"
                            data-slot="icon"
                            fill="currentColor"
                            viewBox="0 0 24 24"
                            xmlns="http://www.w3.org/2000/svg"
                            aria-hidden="true"
                        >
                            <path
                                d="M1.5 8.67v8.58a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3V8.67l-8.928 5.493a3 3 0 0 1-3.144 0L1.5 8.67Z"
                            ></path>
                            <path
                                d="M22.5 6.908V6.75a3 3 0 0 0-3-3h-15a3 3 0 0 0-3 3v.158l9.714 5.978a1.5 1.5 0 0 0 1.572 0L22.5 6.908Z"
                            ></path>
                        </svg>
                        <span>skjoldungar@skjoldungar.is</span>
                    </a>
                </div>
            </div>
            <div class="grid flex-grow grid-cols-1 gap-12 md:grid-cols-3">
                <div>
                    <p class="font-medium text-white">{{ T "footer_scouting" }}</p>
                    <div class="link-column">
                        {{- range site.Menus.footer_col1 }}
                            {{ if eq .Params.Rel "external" }}
                                <div>
                                    <a href="{{ .URL }}" class="external">
                                        {{ .Name }}
                                        <svg class="mt-[1px] h-4 w-4" data-slot="icon" fill="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                            <path clip-rule="evenodd" fill-rule="evenodd"
                                                d="M8.25 3.75H19.5a.75.75 0 0 1 .75.75v11.25a.75.75 0 0 1-1.5 0V6.31L5.03 20.03a.75.75 0 0 1-1.06-1.06L17.69 5.25H8.25a.75.75 0 0 1 0-1.5Z">
                                            </path>
                                        </svg>
                                    </a>
                                </div>
                            {{ else }}
                                <div>
                                    <a href="{{ .PageRef }}">{{ .Name }}</a>
                                </div>
                            {{ end }}
                        {{ end }}
                    </div>
                </div>
                <div>
                    <p class="font-medium text-white">
                        {{ T "footer_cabins" }}
                    </p>
                    <div class="link-column">
                        {{- range site.Menus.footer_col2 }}
                            {{ if eq .Params.Rel "external" }}
                                <div>
                                    <a href="{{ .URL }}" class="external">
                                        {{ .Name }}
                                        <svg class="mt-[1px] h-4 w-4" data-slot="icon" fill="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                            <path clip-rule="evenodd" fill-rule="evenodd"
                                                d="M8.25 3.75H19.5a.75.75 0 0 1 .75.75v11.25a.75.75 0 0 1-1.5 0V6.31L5.03 20.03a.75.75 0 0 1-1.06-1.06L17.69 5.25H8.25a.75.75 0 0 1 0-1.5Z">
                                            </path>
                                        </svg>
                                    </a>
                                </div>
                            {{ else }}
                                <div>
                                    <a href="{{ .PageRef }}">{{ .Name }}</a>
                                </div>
                            {{ end }}
                        {{ end }}
                    </div>
                </div>
                <div>
                    <p class="font-medium text-white">{{ T "footer_skjoldungar" }}</p>
                    <div class="link-column">
                        {{- range site.Menus.footer_col3 }}
                            {{ if eq .Params.Rel "external" }}
                                <div>
                                    <a href="{{ .URL }}" class="external">
                                        {{ .Name }}
                                        <svg class="mt-[1px] h-4 w-4" data-slot="icon" fill="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                            <path clip-rule="evenodd" fill-rule="evenodd"
                                                d="M8.25 3.75H19.5a.75.75 0 0 1 .75.75v11.25a.75.75 0 0 1-1.5 0V6.31L5.03 20.03a.75.75 0 0 1-1.06-1.06L17.69 5.25H8.25a.75.75 0 0 1 0-1.5Z">
                                            </path>
                                        </svg>
                                    </a>
                                </div>
                            {{ else }}
                                <div>
                                    <a href="{{ .PageRef }}">{{ .Name }}</a>
                                </div>
                            {{ end }}
                        {{ end }}
                    </div>
                </div>
            </div>
        </div>
        <div
            class="flex flex-col gap-2 pt-8"
        >
            <p class="text-sm font-medium text-gray-100">
                &copy; 1955 - {{ dateFormat "2006" now }} Skátafélagið
                Skjöldungar
            </p>
            <p class="text-xs font-medium text-gray-100">
                <span class="opacity-50">
                    Umfangsmikil vefhönnun í boði
                </span>
                <a
                    href="https://kjartan.io/"
                    target="_blank"
                    rel="noreferrer"
                    class="inline-flex items-center gap-0.5 transition duration-150 opacity-50 hover:opacity-75"
                >
                    kjartan.io
                    <svg
                        class="h-3 w-3"
                        data-slot="icon"
                        fill="currentColor"
                        viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg"
                        aria-hidden="true"
                    >
                        <path
                            clip-rule="evenodd"
                            fill-rule="evenodd"
                            d="M8.25 3.75H19.5a.75.75 0 0 1 .75.75v11.25a.75.75 0 0 1-1.5 0V6.31L5.03 20.03a.75.75 0 0 1-1.06-1.06L17.69 5.25H8.25a.75.75 0 0 1 0-1.5Z"
                        ></path>
                    </svg>
                </a>
            </p>
        </div>
    </div>
</footer>

<script src="https://unpkg.com/htmx.org@1.9.12"></script>
<script src="/js/nprogress.js"></script>
<script>
    (() => {
        // initialize custom namespace in `window`
        window._www_skjoldungar_is = { active_dropdown: null, dropdown_focus_index: null };

        // begin mobile nav logic
        const btn = document.querySelector('#mobile-nav-toggle');
        const menu = document.querySelector('#mobile-nav');

        document.querySelector('#mobile-nav').style.display = "block";

        btn.addEventListener('click', () => {
            if (btn.dataset.toggled === "false") {
                btn.dataset.toggled = "true";
                menu.dataset.open = "true";
            } else {
                btn.dataset.toggled = "false";
                menu.dataset.open = "false";
            }
        });
        // end mobile nav logic

        // begin mobile dropdown logic
        for (const toggle of document.querySelectorAll('.skj-dropdown')) {
            toggle.addEventListener('click', () => {
                if (toggle.getAttribute('aria-expanded') === "false") {
                    toggle.setAttribute('aria-expanded', 'true');
                } else {
                    toggle.setAttribute('aria-expanded', 'false');
                }
            });
        }
        // end mobile dropdown logic

        // begin menu dropdown logic
        for (const toggle of document.querySelectorAll('.skj-menu-dropdown')) {
            toggle.addEventListener('click', () => {
                if (toggle.getAttribute('aria-expanded') === 'false') {
                    toggle.setAttribute('aria-expanded', 'true');
                    window._www_skjoldungar_is.active_dropdown = toggle.getAttribute('id');
                } else {
                    toggle.setAttribute('aria-expanded', 'false');
                    window._www_skjoldungar_is.active_dropdown = null;
                    window._www_skjoldungar_is.dropdown_focus_index = null;
                }
            });
        }

        document.body.addEventListener('keydown', (e) => {
            if (typeof window._www_skjoldungar_is?.active_dropdown === "string") {
                const options = document.querySelectorAll(`#${window._www_skjoldungar_is.active_dropdown} + .skj-menu-dropdown-content a`);

                switch (e.code) {
                    // close the menu when the escape key is pressed while its active
                    case "Escape":
                        close_dropdown(window._www_skjoldungar_is.active_dropdown);

                        break;
                    
                    // navigate down the menu with arrow keys
                    case "ArrowDown":
                        {
                            e.preventDefault();

                            if (typeof window._www_skjoldungar_is.dropdown_focus_index !== "number") {
                                options[0].focus();
                                window._www_skjoldungar_is.dropdown_focus_index = 0;
                                break;
                            }
                                
                            let new_index = window._www_skjoldungar_is.dropdown_focus_index + 1;
                            if (options[new_index]) {
                                options[new_index].focus();
                                window._www_skjoldungar_is.dropdown_focus_index = new_index;
                                break;
                            }

                            new_index = 0;
                            if (options[new_index]) {
                                options[new_index].focus();
                                window._www_skjoldungar_is.dropdown_focus_index = new_index;
                            }

                            break;
                        }

                    // navigate up the menu with arrow keys
                    case "ArrowUp":
                        {
                            e.preventDefault();

                            if (typeof window._www_skjoldungar_is.dropdown_focus_index !== "number") {
                                const index = options.length - 1;
                                options[index].focus();
                                window._www_skjoldungar_is.dropdown_focus_index = index;
                                break;
                            }

                            let new_index = window._www_skjoldungar_is.dropdown_focus_index - 1;
                            if (options[new_index]) {
                                options[new_index].focus();
                                window._www_skjoldungar_is.dropdown_focus_index = new_index;
                                break;
                            }

                            new_index = options.length - 1;
                            if (options[new_index]) {
                                options[new_index].focus();
                                window._www_skjoldungar_is.dropdown_focus_index = new_index;
                            }

                            break;
                        }
                }
            }
        });

        // when the user clicks off the menu, close the menu
        document.body.addEventListener('click', (e) => {
            if (typeof window._www_skjoldungar_is?.active_dropdown === "string") {
                e.preventDefault();

                if (e.target.id === window._www_skjoldungar_is?.active_dropdown) {
                    return;
                }

                close_dropdown(window._www_skjoldungar_is.active_dropdown);
            }
        });

        function close_dropdown(id) {
            document
                .getElementById(id)
                .setAttribute('aria-expanded', 'false');

            window._www_skjoldungar_is.active_dropdown = null;
            window._www_skjoldungar_is.dropdown_focus_index = null;
        }
        // end menu dropdown logic

        // begin logic for hooking nprogress up to htmx events
        document.body.addEventListener('htmx:xhr:loadstart', () => NProgress.start());
        document.body.addEventListener('htmx:xhr:loadend', () => NProgress.done());
        document.body.addEventListener('htmx:afterRequest', () => NProgress.done());
        document.body.addEventListener('htmx:xhr:abort', () => NProgress.done());
        // end logic for hooking nprogress up to htmx events
    })();
</script>